!function(){var a=angular.module("tickTock",["ngRoute","ui.bootstrap","vAccordion","vModal","ngAudio"]);a.config(["$routeProvider",function(a){a.when("/clock",{templateUrl:"pages/home/home.html",controller:"HomeCtrl as ctrl",resolve:{alarms:["alarmService",function(a){return a.getAlarms()}],auth:["$q","userService",function(a,b){return b.isLogged()?a.when(b.isLogged()):a.reject({authenticated:!1})}]}}).when("/login",{templateUrl:"pages/login/login.html",controller:"LoginCtrl as ctrl"}).otherwise({redirectTo:"/login"})}]).run(["$rootScope","$location",function(a,b){a.$on("$routeChangeError",function(a,c,d,e){e.authenticated===!1&&b.path("/login")}),window.Parse&&Parse.initialize("CS6KFTzGObchb6uUSrzm7poITNBE4IsSqUHDGRci","jfw2ZJpAb08MmLhvabXFlwp5NHyDZ8LbfpLxPwi5")}])}(),function(){"use strict";function a(a){this.$q=a}angular.module("tickTock").service("storageService",a),a.prototype.get=function(a){var b=this.$q.defer(),c=new Parse.Query(a);return c.equalTo("user",Parse.User.current()),c.find({success:function(a){console.log("Successfully retrieved "+a.length+" alarms.");var c=a.map(function(a){var b=a.get("Alarms");return b.alarm=moment(b.alarm),b.recurring=moment.recur(b.recurring),b});b.resolve(c)},error:function(a){console.log("Error: "+a.code+" "+a.message),b.resolve(a)}}),b.promise},a.prototype.set=function(a,b){var c=this.$q.defer(),d=Parse.User.current(),e=Parse.Object.extend(a),f=new e;return f.set(a,b),f.set("user",d),f.save(null,{success:function(a){c.resolve(a)},error:function(){console.log("error")}}),c.promise},a.$inject=["$q"]}(),function(){"use strict";function a(a){this.$q=a}angular.module("tickTock").service("userService",a),a.$inject=["$q"],a.prototype.login=function(a,b){var c=this.$q.defer();return Parse.User.logIn(a,b,{success:function(a){c.resolve({user:a,error:null})},error:function(a,b){c.resolve({user:a,error:b})}}),c.promise},a.prototype.logout=function(){Parse.User.logOut()},a.prototype.isLogged=function(){var a=Parse.User.current();return null!=a},a.prototype.register=function(a,b){var c=this.$q.defer(),d=new Parse.User;return d.set("password",b),d.set("username",a),d.signUp(null,{success:function(a){c.resolve({user:a,error:null})},error:function(a,b){c.resolve({user:a,error:b})}}),c.promise}}(),function(){"use strict";function a(a,b){this.$q=a,this.storageService=b}angular.module("tickTock").service("alarmService",a),a.prototype.getAlarms=function(){var a=this.$q.defer();this.storageService.get("Alarms").then(function(b){a.resolve(b)});return a.promise},a.prototype.setAlarm=function(a){var b=this.$q.defer();this.storageService.set("Alarms",a).then(function(a){b.resolve(a)});return b.promise},a.$inject=["$q","storageService"]}(),function(){"use strict";function a(b){return{modal:b({controller:"ConfigurationWidgetCtrl",controllerAs:"ctrl",templateUrl:"components/configuration-widget/configuration-widget.html"}),setConfig:function(b,c){a.alarms=b,a.instance=c}}}function b(){this.alarms=a.alarms}angular.module("tickTock").factory("configModal",a),b.prototype.close=function(){a.instance.modal.deactivate()},angular.module("tickTock").controller("ConfigurationWidgetCtrl",b),a.$inject=["vModal"]}(),function(){"use strict";angular.module("tickTock").filter("time",function(){return function(a){return a.format("hh:mm:ss")}})}(),function(){"use strict";angular.module("tickTock").filter("timeCompact",function(){return function(a){return moment(a.toISOString()).format("hh:mm a")}})}(),function(){"use strict";function a(a,b){this.alarms=b,this.userService=a,this.registrationUrl="../components/registration/registration.html",console.log(b)}angular.module("tickTock").controller("HomeCtrl",a),a.$inject=["userService","alarms"]}(),function(){"use strict";function a(a,b){this.userService=b,this.$location=a}angular.module("tickTock").controller("LoginCtrl",a),a.prototype.login=function(a){this.userService.login(this.usr,this.psw).then(function(a){a.error?console.log("Unable to login","The data provided is incorrect."):this.$location.path("/clock")}.bind(this))},a.prototype.logout=function(){this.userService.logout(),this.$location.path("/login")},a.prototype.register=function(a){this.userService.register(this.usr,this.psw).then(function(a){a.error?console.log("Unable to register","The data provided is incorrect."):this.$location.path("/clock")}.bind(this))},a.$inject=["$location","userService"]}(),function(){"use strict";function a(a,b,c,d){this.interval=1e3,this.$interval=a,this.alarmService=b,this.date(moment()),this.templateUrl="components/clock/popover.html",this.configModal=c,this.configModal.setConfig(this.alarms,c),this.alarm=d.load("sounds/alarm.mp3"),this.ringing=!1,this.tick()}angular.module("tickTock").directive("clock",function(){return{restrict:"E",templateUrl:"components/clock/clock.html",controller:a,controllerAs:"ctrl",bindToController:!0,scope:{alarms:"="}}}),a.prototype.tick=function(){this.$interval(function(){this.date().add(1,"second")}.bind(this),this.interval)},a.prototype.openModal=function(){this.configModal.modal.activate()},a.prototype.closeModal=function(){this.configModal.modal.deactivate()},a.prototype.checkAlarms=function(a){for(var b in this.alarms){var c=this.alarms[b],d=c.alarm,e=c.recurring;c.on&&e.matches(d)&&d.hour()===a.hour()&&d.minutes()===a.minutes()&&(console.log(c.message),this.ringAlarm())}},a.prototype.ringAlarm=function(){this.ringing||this.alarm.play()},a.prototype.stopAlarm=function(){this.alarm.stop()},a.prototype.snooze=function(a){},a.prototype.date=function(a){return void 0===a?(this.checkAlarms(this._date),this._date):(this._date=a,void this.checkAlarms(a))},a.$inject=["$interval","alarmService","configModal","ngAudio"]}(),function(){"use strict";function a(){var a={restrict:"E",templateUrl:"components/alarm-setter/alarm-setter.html",controller:b,controllerAs:"ctrl",bindToController:!0,scope:{}};return a}function b(a){this.alarmService=a}b.prototype.setAlarmWeekdays=function(){var a;a=moment.recur().every(["Monday","Tuesday","Wednesday","Thursday","Friday"]).daysOfWeek(),this.setAlarm(a,moment(this.alarmTime))},b.prototype.setAlarmWeekends=function(){var a;a=moment.recur().every(["Sunday","Saturday"]).daysOfWeek(),this.setAlarm(a,moment(this.alarmTime))},b.prototype.setAlarmCustom=function(a){var b;b=moment.recur().every(a).daysOfWeek(),this.setAlarm(b,moment(this.alarmTime))},b.prototype.setAlarm=function(a,b){this.alarmService.setAlarm({recurring:a,alarm:b,message:this.alarmName,on:!0}).then(function(a){console.log(a)}.bind(this))},angular.module("tickTock").directive("alarmSetter",a),b.$inject=["alarmService"]}(),function(){"use strict";function a(){var a={restrict:"E",templateUrl:"components/alarm-list/alarm-list.html",controller:b,controllerAs:"ctrl",bindToController:!0,scope:{alarms:"="}};return a}function b(){}b.prototype.method=function(){},angular.module("tickTock").directive("alarmList",a)}();